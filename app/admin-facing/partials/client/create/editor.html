<header class="app-header with-breadcrumbs" data-emmi-navbar>
    <!-- Breadcrumb for transclusion -->
    <ol class="breadcrumb">
        <li><a href="#/clients?{{currentRouteQueryString}}">Search</a></li>
        <li class="active">New Client</li>
    </ol>
</header>
<div id="app-content" role="main" class="app-content container" data-ng-cloak>
    <div class="row">
        <div class="col-md-12">
            <div class="layout-card">
                <form name="clientForm" class="form" novalidate data-unsaved-warning-form>
        <div id="validation-container" data-ng-show="clientForm.$invalid || !clientToEdit.salesForceAccount"></div>
        <h1>New Client Information</h1>
        <div class="row">
            <div class="col-md-8">
                <div class="form-group"
                     data-ng-class="{ 'has-error' : (clientForm.clientName.$invalid && formSubmitted) || clientForm.clientName.$error.unique}">
                    <label class="control-label" for="clientName">Name</label>
                    <div class="error-circle fa-exclamation-circle" role="alert" data-ng-show="clientForm.clientName.$error.required && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Required" aria-label="Required"></div>
                    <div class="error-circle fa-exclamation-circle" role="alert" data-ng-show="clientForm.clientName.$error.pattern && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Please enter a valid client name" aria-label="Please enter a valid client name"></div>
                    <input class="form-control" data-ng-model="clientToEdit.name" id="clientName" name="clientName"
                           type="text" data-unique-url="findNormalizedNameLink" data-unique-client required
                           data-auto-focus
                           data-display-invalid
                           data-ng-pattern="/^[\-\.a-zA-Z0-9 '=_;:`@#&,\(\)\/!]*$/" data-focus-on="clientName">
                </div>
            </div>
            <div class="col-md-4 hidden">
                <label>&nbsp;</label><!-- for spacing purposes -->
                <div class="checkbox">
                    <input id="active" type="checkbox" data-ng-model="clientToEdit.active"/>
                    <label for="active">
                        Active
                    </label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group"
                     data-ng-class="{ 'has-error' : clientForm.clientType.$invalid && formSubmitted }">
                    <label class="control-label" for="clientType">Client Type</label>
                    <div class="error-circle fa-exclamation-circle" role="alert" data-ng-show="clientForm.clientType.$invalid && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Required" aria-label="Required"></div>
                    <select class="form-control" id="clientType" data-ng-model="clientToEdit.type"
                            data-ng-options="type.typeKey | translate for type in clientTypes track by type.id" name="clientType" required
                            data-chosen data-disable-search="true" data-placeholder="Select...">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label class="control-label" for="region">Region</label>
                    <span class="field-note field-optional">optional</span>
                    <select class="form-control" id="region" data-ng-model="clientToEdit.region"
                            data-ng-options="region.typeKey | translate for region in clientRegions track by region.id" name="clientRegion"
                            data-chosen data-disable-search="true" data-placeholder="Select...">
                        <option value="">Select...</option>
                    </select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label class="control-label" for="tier">Tier</label>
                    <span class="field-note field-optional">optional</span>
                    <select class="form-control" id="tier" data-ng-model="clientToEdit.tier"
                            data-ng-options="tier.typeKey | translate for tier in clientTiers track by tier.id" name="clientTier"
                            data-chosen data-disable-search="true" data-placeholder="Select...">
                        <option value="">Select...</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <div class="form-group"
                     data-ng-class="{ 'has-error' : clientForm.clientContractOwner.$invalid && formSubmitted }">
                    <label class="control-label" for="contractOwner">Contract Owner</label>
                    <div class="error-circle fa-exclamation-circle" role="alert" data-ng-show="clientForm.clientContractOwner.$invalid && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Required" aria-label="Required"></div>
                    <select
                            class="form-control"
                            id="contractOwner"
                            data-ng-model="clientToEdit.contractOwner"
                            data-ng-options="owner as owner | contractOwnerFilter for owner in contractOwners track by owner.id "
                            name="clientContractOwner" required
                            data-chosen data-disable-search="true" data-placeholder="Select...">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group"
                     data-ng-class="{ 'has-error' : clientForm.clientContractStart.$invalid && formSubmitted }">
                    <label class="control-label" for="contractStart">Contract Start</label>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="!clientForm.clientContractStart.$error.date &&
                                       !clientForm.clientContractStart.$error.max &&
                                        clientForm.clientContractStart.$error.required && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Required" aria-label="Required"></div>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="clientForm.clientContractStart.$error.date &&
                                      !clientForm.clientContractStart.$error.max && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Dates must be in the format MM/DD/YYYY" aria-label="Dates must be in the format MM/DD/YYYY"></div>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="clientForm.clientContractStart.$error.date &&
                                       clientForm.clientContractStart.$error.max && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Please select a valid date" aria-label="Please select a valid date"></div>
                    <input id="contractStart" class="form-control" placeholder="MM/DD/YYYY" type="text" name="clientContractStart"
                           data-ng-model="clientToEdit.contractStart" data-autoclose="true"
                           data-date-format="MM/dd/yyyy"
                           data-dateType="string" data-bs-datepicker required
                           data-max-date="{{clientToEdit.contractEnd}}" data-trigger="manual">
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group"
                     data-ng-class="{ 'has-error' : clientForm.clientContractEnd.$invalid && formSubmitted }">
                    <label class="control-label" for="contractEnd">Contract End</label>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="!clientForm.clientContractEnd.$error.date &&
                                       !clientForm.clientContractEnd.$error.min &&
                                        clientForm.clientContractEnd.$error.required && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Required" aria-label="Required"></div>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="clientForm.clientContractEnd.$error.date &&
                                      !clientForm.clientContractEnd.$error.min && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Dates must be in the format MM/DD/YYYY" aria-label="Dates must be in the format MM/DD/YYYY"></div>
                    <div class="error-circle fa-exclamation-circle" role="alert"
                         data-ng-show="clientForm.clientContractEnd.$error.date &&
                                       clientForm.clientContractEnd.$error.min && formSubmitted"
                         data-bs-tooltip data-placement="right" data-type="danger" data-container="body"
                         data-title="Please select a valid date" aria-label="Please select a valid date"></div>
                    <input id="contractEnd" class="form-control" placeholder="MM/DD/YYYY" type="text" name="clientContractEnd"
                           data-ng-model="clientToEdit.contractEnd" data-autoclose="true"
                           data-dateType="string" data-bs-datepicker required data-date-format="MM/dd/yyyy"
                           data-min-date="{{clientToEdit.contractStart | addDays:1}}" data-trigger="manual">
                </div>
            </div>
        </div>
        <div class="row" data-ng-hide="updatingSalesForceAccount || clientToEdit.salesForceAccount == null">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-12">
                        <label class="control-label" for="">Salesforce Account</label>
                    </div>
                </div>
                {{clientToEdit.salesForceAccount.name}}&nbsp;&nbsp;&nbsp;&nbsp;
                <span>{{clientToEdit.salesForceAccount.city}}<span
                        data-ng-show="clientToEdit.salesForceAccount.city && clientToEdit.salesForceAccount.state">,&nbsp;</span>{{clientToEdit.salesForceAccount.state}}
                </span>
                <button class="btn btn-link btn-salesforce-update" type="button"
                        data-focus-after-typeahead
                        data-ng-disabled="whenSaving"
                        data-ng-click="changeClientSfAccount()">update
                </button>
            </div>
        </div>
        <div class="row" data-ng-show="updatingSalesForceAccount || clientToEdit.salesForceAccount == null"
             data-ng-include="'admin-facing/partials/client/salesforce/salesforce.html'"></div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-actions">
                    <div class="form-group">
                        <button class="btn btn-primary" type="button"
                                data-on-ok="save(clientForm)"
                                data-save-click data-client-to-edit="clientToEdit" data-checking-for-dupes="checkingForDupes"
                                data-ng-disabled="clientForm.clientName.$error.unique || whenSaving">
                            <span data-translate="client_edit_page.save_button">Continue...</span>
                        </button>
                        <button class="btn btn-cancel" type="button"
                                data-ng-disabled="whenSaving"
                                data-ng-click="cancel()"
                                data-analytics-on
                                data-analytics-category="Form Action"
                                data-analytics-event="Client Create" data-analytics-label="Cancel">cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
            </div><!-- .layout-card -->
        </div><!-- .col-md-12 -->
    </div><!-- .row -->
</div><!-- .container -->
<footer class="footer" data-ng-include="'admin-facing/partials/common/footer.tpl.html'"></footer>
